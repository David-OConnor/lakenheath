{% extends "base.html" %}

{% block content %}

    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.23/angular.min.js"></script>

    <script type="text/javascript">
        myModule = angular.module('sortApp', [])

        .controller('mainController', function($scope) {
            $scope.sortType     = 'callsign'; // set the default sort type
            $scope.sortReverse  = false;  // set the default sort order
            $scope.searchPanthers   = '';     // set the default search/filter term

            $scope.panthersJs = {{ panthers_js|safe }};
        });


    {#    Interpolation prevents conflicts with Jinja template tags; Angular
    will now use '{[{' instead of '{{'.#}
    myModule.config(function($interpolateProvider) {
        $interpolateProvider.startSymbol('{[{').endSymbol('}]}');
    });

    </script>


    <div class="container" ng-app="sortApp" ng-controller="mainController">

         <form>
             <div class="form-group">
                 <div class="input-group">
                     <div class="input-group-addon"><i class="fa fa-search"></i></div>

                     <input type="text" class="form-control" placeholder="Search" ng-model="searchPanthers">

                 </div>
             </div>
          </form>

        <table class="table table-striped">
            <thead>
                <tr>
                    <th>
                        <a href="#" ng-click="sortType = 'last_name'; sortReverse = !sortReverse">
                            Name
                            <span ng-show="sortType == 'last_name' && !sortReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortType == 'last_name' && sortReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th>

                    <th>
                        <a href="#" ng-click="sortType = 'callsign'; sortReverse = !sortReverse">
                            Callsign
                            <span ng-show="sortType == 'callsign' && !sortReverse" class="fa fa-caret-down"></span>
                            <span ng-show="sortType == 'callsign' && sortReverse" class="fa fa-caret-up"></span>
                        </a>
                    </th>

                    <th>Email</th>
                    <th>Phone (44+)</th>

                </tr>
            </thead>

            <tbody>
{#                <tr ng-repeat="roll in sushi | orderBy:sortType:sortReverse | filter:searchFish">#}
{#                    <td>{[{ roll.name }]}</td>#}
{#                    <td>{[{ role.fish }]}</td>#}
{#                    <td>{[{ role.tastiness }]}</td>#}
{#                </tr>#}

                <tr ng-repeat="panther in panthersJs | orderBy:sortType:sortReverse | filter:searchPanthers">
                    <td>{[{ panther.full_name }]}</td>
                    <td>{[{ panther.callsign }]}</td>
                    <td><a href="mailto:{[{ panther.email }]}">{[{ panther.email }]}</a></td>
                    <td><a href="tel:+44{[{ panther.phone }]}">{[{ panther.phone_formatted }]}</a></td>
                </tr>

            </tbody>
        </table>

    </div>



    <h4><a href="/">Home</a></h4>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>Name</th>
                <th>Callsign</th>
                <th>Email</th>
                <th>Phone (44+)</th>
            </tr>
        </thead>

        <tbody>
            {% for panther in panthers %}
            <tr>
                <td>{{ " ".join([panther.first_name, panther.last_name])}}</td>
                <td>{{ panther.callsign }}</td>
                <td><a href="mailto:{{ panther.email }}">{{ panther.email }}</a></td>
                <td><a href="tel:+44{{ panther.phone }}">{{ panther.phone_formatted() }}</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

{% endblock %}